\begin{figure}[htp]
  \centering
  \begin{tikzpicture}
    \node [rectangle, draw=darkblue, very thick, minimum width=3cm,minimum height=1.4cm, inner sep=.3cm] at (1,10) (Br) {Navegador};
    \node [align=center,rectangle, draw=darkblue, very thick, minimum height=1.4cm,inner sep=.3cm] at (7,10) (Vul) {Sitio Vulnerable \\ \texttt{https://vuln.com}};
    \node [align=center,rectangle, draw=darkblue, very thick, minimum
    height=1.4cm,inner sep=.3cm] at (13,10) (Evil) {Sitio Maligno \\ \texttt{https://evil.com}};

    \node at (4.2,8.3) (s1) {\texttt{POST /login}};
    \node [shape=circle, draw, outer sep=2pt, inner sep=0.8pt,left=0cm of s1] (c1) {1};
    \draw[color=lightblue,very thick] (1.15,8.3) to (c1);
    \draw[-{Latex[length=2mm]}, color=lightblue,very thick] (s1) to (6.85,8.3);

    \node at (4.2,7.3) (s2) {\texttt{Cookie: session=XYZ}};
    \node [shape=circle, draw, outer sep=2pt, inner sep=0.8pt,left=0cm of s2] (c2) {2};
    \draw[{Latex[length=2mm]}-, color=lightblue,dashed, very thick] (1.15,7.3) to (c2);
    \draw[color=lightblue,dashed,very thick] (s2) to (6.85,7.3);

    \node at (4.2,6.3) (s3) {\texttt{GET /home}};
    \node[shape=circle, draw, outer sep=2pt, inner sep=0.8pt,left=0cm of s3] (c3) {3};
    \draw[color=lightblue,very thick] (1.15,6.3) to (c3);
    \draw[color=lightblue,-{Latex[length=2mm]},very thick] (s3) to (12.85,6.3);

    \node at (4.2,5.3) (s4) {\texttt{home.html}};
    \node[shape=circle, draw, outer sep=2pt, inner sep=0.8pt,left=0cm of s4] (c4) {4};
    \draw[color=lightblue,{Latex[length=2mm]}-,dashed,very thick] (1.15,5.3) to (c4);
    \draw[color=lightblue,dashed,very thick] (s4) to (12.85,5.3);

    \node[draw, inner sep=.2cm] at (7,4.3) (b1) {\footnotesize \verb+<img src="https://vuln.com/account/delete" style="display:none">+};
    \draw[color=lightblue,dotted,very thick] (s4) to (b1);

    \node at (4.2,3.3) (s5) {\texttt{GET /account/delete}};
    \node[shape=circle, draw, outer sep=2pt, inner sep=0.8pt,left=0cm of s5] (c5) {5};
    \draw[color=lightblue,very thick] (1.15,3.3) to (c5);
    \draw[-{Latex[length=2mm]},color=lightblue,very thick] (s5) to (6.85,3.3);

    \node[draw, inner sep=.2cm] at (5,2.3) (b2) {\footnotesize \texttt{Cookie: session=XYZ}};
    \draw[color=lightblue,dotted,very thick] (s5) to (b2);

    \node at (9.2,2.3) (s6) {Borrar cuenta};
    \node [shape=circle, draw, outer sep=2pt, inner sep=0.8pt,left=0cm of s6] (c6) {6};
    \draw [color=lightblue,very thick](7.15,3) -| (s6);
    \draw [color=lightblue,very thick,{Latex[length=2mm]}-] (7.15,1.6) -| (s6);

    \draw [thick,color=darkblue] (0.85,1) rectangle (1.15, 8.5);
    \draw [thick,color=darkblue] (6.85,7.3) rectangle (7.15, 8.3);
    \draw [thick,color=darkblue] (12.85,5.3) rectangle (13.15, 6.3);
    \draw [thick,color=darkblue] (6.85,3.3) rectangle (7.15, 1.3);

    \draw[densely dashed, color=darkerblue,thick] (Br) -- (1,8.5);
    \draw[densely dashed, color=darkerblue,thick] (1,1) to (1,0.5);
    \draw[densely dashed, color=darkerblue,dash phase=2pt, thick] (Vul) -- (7,8.3);
    \draw[dashed, color=darkerblue,thick] (Evil) -- (13,6.3);
    \draw[dashed, color=darkerblue,thick] (13,5.3) to (13,0.5);
    \draw[dashed, color=darkerblue,thick] (7,3.3) -- (b1);
    \draw[dashed, color=darkerblue,thick] (7,1.3) -- (7,0.5);
    \draw[dashed, color=darkerblue,thick] (b1) to (7,7.3);
  \end{tikzpicture}
  \caption{Esquema de un ejemplo de CSRF.\label{fig:ex}}
\end{figure}

